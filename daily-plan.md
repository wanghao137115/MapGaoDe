# React 智能地图应用平台 - 20 天开发计划（Daily Plan）

> 说明：本文件按「天」划分任务，覆盖约 20 天的开发周期。  
> 实际开发中可以根据进度灵活调整、拆分或合并任务。

---

## 第 1 天：项目初始化 & 基础依赖

### 🎯 今日目标
- 完成项目脚手架初始化（Vite + React 18 + TS）
- 集成 Ant Design 5，搭建基础布局
- 配置基础开发工具链（ESLint + Prettier + Husky 草稿）

### ✅ 今日任务清单
- **项目创建与基础配置**
  - [ ] 使用 Vite 创建 React + TypeScript 项目
  - [ ] 安装依赖：`react-router-dom`, `antd`, `axios`, `zustand`, `lodash-es`, `dayjs`
  - [ ] 配置 Ant Design（引入样式、`ConfigProvider`）
  - [ ] 配置基础别名（如 `@` 指向 `src`）

- **基础目录结构**
  - [ ] 创建基础目录：`components/`, `hooks/`, `services/`, `stores/`, `pages/`, `styles/`, `types/`, `utils/`
  - [ ] 为主要目录新增占位文件（避免空目录）

- **开发工具链（初版）**
  - [ ] 添加 ESLint + TypeScript 相关配置
  - [ ] 添加 Prettier 配置
  - [ ] 预留 Husky + lint-staged 配置文件（可后续完善）

---

## 第 2 天：路由 & 基础布局框架

### 🎯 今日目标
- 建立路由体系（React Router v6）
- 定义主布局（侧边菜单 + 顶部导航 + 内容区域）
- 为后续页面预留路由入口

### ✅ 今日任务清单
- **路由结构**
  - [ ] 创建路由配置文件（基础路由：主页、地图演示页、业务场景页等占位）
  - [ ] 实现路由懒加载（如有必要）

- **主布局**
  - [ ] 使用 AntD `Layout` 组件搭建基础结构（Sider + Header + Content）
  - [ ] 创建菜单配置（如：基础地图、物流追踪、门店定位等入口）
  - [ ] 在 Layout 中嵌套路由 `Outlet`

- **页面占位**
  - [ ] 创建 `pages/MapPlayground`、`pages/LogisticsTracking`、`pages/StoreLocator` 占位组件
  - [ ] 将上述页面接入路由和菜单导航

---

## 第 3 天：高德地图加载服务 & 环境变量

### 🎯 今日目标
- 封装高德地图 JS API v2.0 动态加载服务
- 配置环境变量（含占位 Key）
- 定义地图配置类型和基础工具函数

### ✅ 今日任务清单
- **环境变量**
  - [ ] 新建 `.env.example`：`VITE_AMAP_KEY=YOUR_AMAP_KEY_HERE`、`VITE_API_BASE=https://api.example.com`
  - [ ] 在代码中统一使用 `import.meta.env.VITE_AMAP_KEY || 'DEV_PLACEHOLDER_KEY'`

- **地图加载服务**
  - [ ] 在 `services/map` 中实现加载高德 JS 的函数（动态加载脚本）
  - [ ] 管理加载状态（未加载 / 加载中 / 成功 / 失败 / 缺少 Key）
  - [ ] Key 缺失或加载失败时给出清晰错误/警告（console + Promise 返回状态）

- **类型与工具**
  - [ ] 定义基础地图配置类型（地图中心点、缩放级别等）
  - [ ] 预留路径规划、聚合相关类型接口（先定义基本结构）

---

## 第 4 天：基础地图组件 MapContainer（1）

### 🎯 今日目标
- 实现基础地图容器组件骨架
- 管理地图实例生命周期
- 提供 `onMapReady` 回调

### ✅ 今日任务清单
- **组件结构**
  - [ ] 在 `components/Map` 下创建 `MapContainer` 组件
  - [ ] 接收 props：`center`、`zoom`、`mapType`（普通/卫星/3D）、`onMapReady`
  - [ ] 使用 `useEffect` 管理地图实例初始化与销毁

- **实例生命周期**
  - [ ] 确保组件重复渲染不会重复初始化地图实例
  - [ ] 组件卸载时销毁地图实例，释放资源

- **Key 缺失处理**
  - [ ] 当地图加载服务返回“缺失 Key”状态时，不创建地图实例
  - [ ] 显示 AntD `Result`/`Alert`，提示需要配置 `VITE_AMAP_KEY`

---

## 第 5 天：基础地图组件 MapContainer（2）+ 控件

### 🎯 今日目标
- 集成地图控件（缩放、比例尺、工具条、地图类型切换）
- 支持基础地图类型切换
- 在演示页面中完成首次可视地图渲染

### ✅ 今日任务清单
- **控件集成**
  - [ ] 在 `MapContainer` 中添加缩放控件
  - [ ] 添加比例尺控件
  - [ ] 添加工具条控件
  - [ ] 添加地图类型切换控件（普通 / 卫星 / 3D）

- **地图类型支持**
  - [ ] 根据 `mapType` props 切换底图类型
  - [ ] 考虑与主题切换兼容性（预留扩展）

- **演示页面**
  - [ ] 在 `MapPlayground` 页面中使用 `MapContainer` 展示地图
  - [ ] 简单添加地图中心点、缩放级别的初始配置

---

## 第 6 天：定位功能 & useGeolocation Hook

### 🎯 今日目标
- 封装浏览器定位 Hook
- 将定位集成到演示页面
- 处理定位失败场景

### ✅ 今日任务清单
- **useGeolocation Hook**
  - [ ] 在 `hooks/useGeolocation` 中封装 `navigator.geolocation` 调用
  - [ ] 管理状态：`position` / `loading` / `error`

- **地图联动**
  - [ ] 在 `MapPlayground` 中使用 `useGeolocation`
  - [ ] 成功定位后，将 `MapContainer` 中心点移动至当前位置
  - [ ] 定位失败时使用 AntD `message.error` 提示

- **UI 交互**
  - [ ] 添加「定位到我」按钮，触发定位逻辑

---

## 第 7 天：Zustand 地图状态 & 标记状态基础

### 🎯 今日目标
- 建立地图相关全局状态 store
- 建立标记点 store 的基础结构
- 定义 Marker 类型

### ✅ 今日任务清单
- **map.store.ts**
  - [ ] 存储：当前中心点、缩放级别、地图类型、选中 Marker 等
  - [ ] 提供 actions：`setCenter`、`setZoom`、`setMapType`、`setSelectedMarkerId`

- **markers.store.ts**
  - [ ] 定义 `Marker` 接口（id / position / title / type / icon / data / createdAt / updatedAt）
  - [ ] 提供基础 actions：`setMarkers`、`addMarker`、`updateMarker`、`removeMarker`

- **联调演示**
  - [ ] 在 `MapPlayground` 中简单从 store 中读取地图配置和标记列表（可用假数据）

---

## 第 8 天：标记渲染层 & 基础交互

### 🎯 今日目标
- 实现 `MarkerLayer` 组件
- 支持基础 Marker 交互（点击、拖拽）
- 与 Zustand store 联动

### ✅ 今日任务清单
- **MarkerLayer 组件**
  - [ ] 在 `components/Map` 中创建 `MarkerLayer`
  - [ ] 接收 props：`markers`、`onMarkerClick`、`onMarkerDragEnd`
  - [ ] 在地图上渲染 AMap.Marker 实例

- **交互事件**
  - [ ] Marker 点击时触发 `onMarkerClick(id)` 回调
  - [ ] 支持拖拽，拖拽结束时触发 `onMarkerDragEnd(id, newPosition)`

- **与 store 联动**
  - [ ] 在某个页面中，将 `markers.store` 的数据渲染到地图
  - [ ] 拖拽更新时调用 store 的 `updateMarker` 更新位置信息

---

## 第 9 天：标记 CRUD & 搜索/筛选

### 🎯 今日目标
- 完成标记点的增删改查 UI
- 支持简单搜索/筛选

### ✅ 今日任务清单
- **新增/删除**
  - [ ] 点击地图任意位置添加一个新 Marker（临时表单）
  - [ ] 在侧边列表中支持删除单个 Marker
  - [ ] 支持多选 + 批量删除

- **编辑**
  - [ ] 提供编辑标记信息的表单（标题、类型、自定义数据）
  - [ ] 更新后写回 `markers.store`

- **搜索/筛选**
  - [ ] 提供搜索框（按名称模糊匹配）
  - [ ] 提供按类型筛选（store/warehouse/user/vehicle）

---

## 第 10 天：信息弹窗系统（1）- 基础

### 🎯 今日目标
- 实现通用信息弹窗 UI 组件
- 支持地图上点击 Marker 打开弹窗

### ✅ 今日任务清单
- **信息弹窗组件**
  - [ ] 在 `components/UI` 中创建通用信息弹窗组件
  - [ ] 支持展示：标题、文本、图片占位、链接、操作按钮区域

- **地图联动**
  - [ ] 在某地图页面中：点击 Marker → 打开对应信息弹窗
  - [ ] 抽象弹窗为独立组件，props 接收 `marker` 数据

- **布局与关闭**
  - [ ] 支持在地图上方浮动显示或侧边显示（先实现一种）
  - [ ] 支持关闭弹窗，并同步清理选中状态

---

## 第 11 天：信息弹窗系统（2）- 响应式 & 操作

### 🎯 今日目标
- 优化信息弹窗的响应式布局
- 支持在弹窗中触发操作（占位行为）

### ✅ 今日任务清单
- **响应式**
  - [ ] 在桌面端显示较大的详情弹窗
  - [ ] 在移动端采用抽屉/底部弹出样式（可用 AntD Drawer）

- **操作按钮**
  - [ ] 提供“导航”“拨打电话”等操作按钮（暂用链接占位）
  - [ ] 在代码中注释未来接入真实业务逻辑的方式

- **动画效果**
  - [ ] 为弹窗添加基本入场/退场动画（简单即可）

---

## 第 12 天：路径规划服务封装（1）

### 🎯 今日目标
- 在 `services/map` 中封装路径规划服务（驾车 & 步行）
- 定义统一的路径规划结果数据结构

### ✅ 今日任务清单
- **服务封装**
  - [ ] 封装驾车路线规划（Driving）
  - [ ] 封装步行路线规划（Walking）

- **数据结构**
  - [ ] 提取 polyline 信息（经纬度数组）
  - [ ] 提取概要信息（距离、时间、收费）

- **错误处理**
  - [ ] 规划失败时给出错误状态与消息

---

## 第 13 天：路径规划 UI & 路径绘制

### 🎯 今日目标
- 构建路径规划 UI（起点/终点/途经点表单）
- 在地图上绘制规划出的路径

### ✅ 今日任务清单
- **UI 表单**
  - [ ] 在某页面（可新建 PathPlanning 页面）中实现起点/终点输入表单
  - [ ] 支持选择路径模式（驾车/步行）

- **路径绘制**
  - [ ] 调用路径规划服务获取 polyline
  - [ ] 在地图上根据 polyline 绘制折线
  - [ ] 使用不同颜色区分不同模式

- **路径详情展示**
  - [ ] 在侧边面板显示距离、预计时间、收费等信息

---

## 第 14 天：聚合点（MarkerCluster）基础

### 🎯 今日目标
- 集成 AMap.MarkerCluster
- 实现 `MarkerClusterLayer` 组件

### ✅ 今日任务清单
- **聚合组件**
  - [ ] 在 `components/Map` 中创建 `MarkerClusterLayer`
  - [ ] 接收 markers 和 clusterOptions
  - [ ] 按当前视野与 zoom 进行点聚合

- **基础样式**
  - [ ] 配置简单的聚合样式（不同数量级颜色/大小）

- **交互**
  - [ ] 点击聚合点时，放大到合理级别或展开内部标记

---

## 第 15 天：业务场景 - 物流追踪（1）基础

### 🎯 今日目标
- 创建物流追踪业务模块骨架
- 实现车辆列表和地图联动基础

### ✅ 今日任务清单
- **模块结构**
  - [ ] 在 `components/Business` 中创建 `LogisticsTracking` 模块
  - [ ] 在 `pages/LogisticsTracking` 中引入该模块

- **车辆数据**
  - [ ] 使用模拟数据定义多辆“车辆” Marker（type: 'vehicle'）
  - [ ] 在地图上显示车辆当前位置

- **基础 UI**
  - [ ] 侧边显示车辆列表（ID / 状态）
  - [ ] 点击列表项高亮对应地图 Marker

---

## 第 16 天：业务场景 - 物流追踪（2）轨迹 & 时间线

### 🎯 今日目标
- 模拟车辆轨迹移动
- 实现配送过程时间线视图

### ✅ 今日任务清单
- **轨迹模拟**
  - [ ] 使用定时器/动画模拟车辆沿路径移动
  - [ ] 在地图上用 polyline 展示历史轨迹

- **状态管理**
  - [ ] 区分车辆状态：配送中、已到达、异常等
  - [ ] 用不同图标/颜色表示不同状态

- **时间线 UI**
  - [ ] 使用 AntD `Timeline` 或 `Steps` 展示某订单的配送节点

---

## 第 17 天：业务场景 - 门店定位（1）筛选 & 列表

### 🎯 今日目标
- 创建门店定位业务模块
- 实现门店筛选 + 列表 + 地图联动

### ✅ 今日任务清单
- **模块结构**
  - [ ] 在 `components/Business` 中创建 `StoreLocator` 模块
  - [ ] 在 `pages/StoreLocator` 中引入该模块

- **门店筛选**
  - [ ] 支持按城市、区域、门店类型筛选

- **列表 & 地图联动**
  - [ ] 列表展示门店信息（名称、地址、类型等）
  - [ ] 点击列表项定位到对应 Marker 并打开弹窗

---

## 第 18 天：业务场景 - 门店定位（2）服务范围 & 营业状态

### 🎯 今日目标
- 显示门店服务范围（圆形/多边形）
- 显示和管理门店营业状态

### ✅ 今日任务清单
- **服务范围**
  - [ ] 根据门店坐标和服务半径绘制圆形覆盖物
  - [ ] 如有复杂服务范围，绘制多边形区域

- **营业状态**
  - [ ] 显示门店当前营业状态（营业中/休息中等）
  - [ ] 在 UI 中用颜色/徽标区分

- **信息弹窗扩展**
  - [ ] 在门店弹窗中展示营业时间、服务范围摘要等

---

## 第 19 天：地图工具 - 绘制 / 测距 / 面积 / 截图 / 分享

### 🎯 今日目标
- 实现地图工具栏和多种工具能力

### ✅ 今日任务清单
- **区域绘制**
  - [ ] 支持绘制圆形、多边形区域
  - [ ] 可查看/清除已绘制区域

- **测距 & 面积**
  - [ ] 测距工具：按顺序点击，显示总距离
  - [ ] 面积测量：对多边形区域计算面积并展示

- **截图 & 分享**
  - [ ] 提供按钮尝试进行地图截图（如有跨域限制，在文档说明限制与替代方案）
  - [ ] 基于当前中心点 & 缩放级别生成分享链接（前后端协议写在注释与文档中）

---

## 第 20 天：性能优化、测试补齐 & 文档整理

### 🎯 今日目标
- 进行一轮性能优化
- 补齐关键测试用例
- 整理 README 与需求文档

### ✅ 今日任务清单
- **性能优化**
  - [ ] 为地图相关组件添加 `React.memo`、`useMemo`、`useCallback` 等优化
  - [ ] 检查标记渲染和聚合是否存在明显性能瓶颈
  - [ ] 如有必要，将重计算逻辑移入 Web Worker

- **测试**
  - [ ] 为核心 hooks（`useMap`, `useGeolocation` 等）补充单元测试
  - [ ] 为关键 UI 组件（地图容器、标记列表、信息弹窗、业务模块）编写组件测试
  - [ ] 编写 1–2 个集成测试（添加标记 → 弹窗 → 删除、基础路径规划流程）

- **文档**
  - [ ] 更新 `README`：项目简介、安装运行、环境变量、构建与部署说明
  - [ ] 检查并补充 `requirements.md` 中的需求与实际实现差异说明

---

> 提示：后续如果周期延长，可以在本文件尾部继续追加“第 21 天、第 22 天…”等日程安排。


